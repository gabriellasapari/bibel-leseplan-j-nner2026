<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<title>31 Hari Bersama Yesus ‚Äì Bacaan Alkitab</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>

/* ---------------------------------------------------
   DARK LUXE (BLACK + GOLD) UI
--------------------------------------------------- */

:root {
  --bg: #0c0c0c;
  --card-bg: #141414;
  --text: #e8e8e8;
  --muted: #9c9c9c;
  --gold: #d4af37;
  --gold-soft: #a98b2c;
  --border: #2a2a2a;
  --radius: 14px;
}

/* LIGHT MODE */
body[data-theme="light"] {
  --bg: #f8f5e9;
  --card-bg: #fffdf8;
  --text: #2c2415;
  --muted: #6a6047;
  --gold: #b68a2c;
  --border: #e2d3b8;
}

body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: var(--bg);
  color: var(--text);
}

/* ---------------------------------------------------
   PAGE WRAPPER
--------------------------------------------------- */

.page {
  max-width: 980px;
  margin: 0 auto;
  padding: 28px 18px 60px;
}

/* ---------------------------------------------------
   HEADER
--------------------------------------------------- */

.header-actions {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}

.header-btn {
  padding: 7px 14px;
  border-radius: 999px;
  border: 1px solid var(--gold);
  background: transparent;
  color: var(--gold);
  cursor: pointer;
  font-size: 14px;
  font-weight: 600;
  transition: 0.25s;
}

.header-btn:hover {
  background: var(--gold);
  color: black;
  box-shadow: 0 0 12px rgba(212,175,55,0.6);
}

/* ---------------------------------------------------
   TITLE BLOCK
--------------------------------------------------- */

h1 {
  margin: 12px 0 6px;
  font-size: 32px;
  color: var(--gold);
}

.subtitle {
  color: var(--muted);
  font-size: 14px;
  margin-bottom: 20px;
}

.intro-card {
  background: var(--card-bg);
  border: 1px solid var(--border);
  padding: 16px 20px;
  border-radius: var(--radius);
  line-height: 1.5rem;
  margin-top: 16px;
  box-shadow: 0 0 22px rgba(212,175,55,0.05);
}

/* ---------------------------------------------------
   NAVIGATION (TABS)
--------------------------------------------------- */

.main-nav {
  margin-top: 22px;
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.nav-tab {
  padding: 8px 18px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: var(--card-bg);
  color: var(--text);
  cursor: pointer;
  transition: 0.25s;
  font-size: 14px;
}

.nav-tab:hover {
  background: var(--gold);
  color: black;
}

.nav-tab.is-active {
  background: var(--gold);
  color: black;
  box-shadow: 0 0 12px rgba(212,175,55,0.6);
}

/* ---------------------------------------------------
   TAB SECTIONS
--------------------------------------------------- */

.tab-section {
  display: none;
  animation: fadeIn 0.4s ease;
}

.tab-section.active {
  display: block;
}

/* ---------------------------------------------------
   DAY LIST
--------------------------------------------------- */

.layout {
  margin-top: 28px;
  display: grid;
  grid-template-columns: 3fr 2fr;
  gap: 20px;
}

@media(max-width: 850px) {
  .layout { grid-template-columns: 1fr; }
}

.card {
  background: var(--card-bg);
  border: 1px solid var(--border);
  padding: 18px;
  border-radius: var(--radius);
}

.day-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.day-card {
  display: flex;
  gap: 14px;
  padding: 12px 14px;
  border-radius: var(--radius);
  background: #111;
  border: 1px solid #222;
  transition: 0.2s;
}

.day-card:hover {
  border-color: var(--gold);
  box-shadow: 0 0 15px rgba(212,175,55,0.15);
}

.day-num {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: var(--gold);
  color: black;
  display: none !important;
  align-items: center;
  justify-content: center;
  font-weight: 700;
}

.day-title {
  font-size: 15px;
  font-weight: 600;
}

.day-ref {
  font-size: 13px;
  color: var(--muted);
}

/* BUTTON "done" */
.btn-small {
  padding: 6px 12px;
  border-radius: 999px;
  border: 1px solid var(--gold);
  background: transparent;
  color: var(--gold);
  cursor: pointer;
  font-size: 12px;
}

.btn-small.is-done {
  background: var(--gold);
  color: black;
}

.reset-link {
  color: var(--muted);
  font-size: 11px;
  cursor: pointer;
}

/* ---------------------------------------------------
   PROGRESS BAR
--------------------------------------------------- */

.progress-bar {
  height: 12px;
  background: #333;
  border-radius: 999px;
  border: 1px solid #555;
  margin-top: 6px;
}

.progress-fill {
  height: 100%;
  width: 0;
  background: linear-gradient(90deg, var(--gold), #f0d98a);
  border-radius: 999px;
  transition: width 0.35s ease-out;
}
   
.bible-note {
  margin-top: 10px;
  font-size: 11px;
  color: var(--muted);
  text-align: center;
}
   
/* ---------------------------------------------------
   ABOUT & JOURNAL
--------------------------------------------------- */

.about-card,
.journal-card {
  background: var(--card-bg);
  padding: 20px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
}

.journal-textarea {
  width: 100%;
  min-height: 180px;
  padding: 12px;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: #111;
  color: var(--text);
  font-size: 15px;
}

/* SAVE BUTTON */
.journal-save-btn {
  margin-top: 10px;
  padding: 8px 16px;
  border-radius: 999px;
  background: var(--gold);
  border: none;
  cursor: pointer;
  font-weight: bold;
  color: black;
}

/* MUSIC SELECT */
.music-select {
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid var(--gold);
  background: #111;
  color: var(--gold);
}

/* ---------------------------------------------------
   ANIMATION
--------------------------------------------------- */

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(6px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* ---------------------------------------------------
   LEVEL 3: TODAY BADGE + FOCUS MODE + JOURNAL CONTROLS
--------------------------------------------------- */

/* Hari "hari ini" */
.day-card.today {
  border-color: var(--gold);
  box-shadow: 0 0 18px rgba(212,175,55,0.35);
  position: relative;
}

.today-badge {
  position: absolute;
  top: 6px;
  right: 10px;
  font-size: 11px;
  padding: 2px 8px;
  border-radius: 999px;
  background: rgba(212,175,55,0.18);
  border: 1px solid rgba(212,175,55,0.6);
  color: var(--gold);
}

/* Pagi / Malam layout */
.day-ref-row {
  display: flex;
  gap: 6px;
  align-items: baseline;
  font-size: 13px;
}

.day-ref-label {
  padding: 2px 8px;
  border-radius: 999px;
  background: rgba(212,175,55,0.08);
  border: 1px solid rgba(212,175,55,0.4);
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--gold);
}

.ref-link-text {
  background: none;
  border: none;
  padding: 0 0 0 4px;
  font-size: 13px;
  color: var(--text);
  cursor: pointer;
}

.ref-link-text:hover {
  color: var(--gold);
  text-decoration: underline;
}

/* Focus Overlay */
.focus-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.75);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 50;
}

.focus-overlay.is-open {
  display: flex;
}

.focus-dialog {
  background: #111;
  border-radius: 18px;
  padding: 20px 22px;
  width: min(90vw, 480px);
  border: 1px solid var(--gold);
  box-shadow: 0 0 30px rgba(212,175,55,0.5);
}

.focus-close {
  float: right;
  border: none;
  background: transparent;
  color: var(--muted);
  font-size: 20px;
  cursor: pointer;
}

/* Journal controls */
.journal-controls {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-bottom: 10px;
  flex-wrap: wrap;
}

.journal-controls label {
  font-size: 13px;
}

.journal-controls select {
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: #111;
  color: var(--text);
}

</style>
</head>

<body>

<div class="page">

  <!-- HEADER BUTTONS -->
  <div class="header-actions">
    <button id="lang-toggle" class="header-btn">DE</button>
    <select id="music-select" class="music-select">
      <option value="ambient">Ambient Worship</option>
    </select>

    <!-- Play / Pause Musik -->
  <button id="music-play" class="header-btn">‚ñ∂</button>
     
    <button id="theme-toggle" class="header-btn">‚òÄ</button>
  </div>

  <h1>31 Hari Bersama Yesus</h1>
  <p class="subtitle">Bacaan Alkitab ‚Äì Januari 2026</p>

  <div class="intro-card">
    Luangkan waktu <strong>10‚Äì20 menit</strong> setiap hari untuk membaca, merenungkan dan berdoa.
    Tunjukkan kesetiaanmu kepada Tuhan Yesus Kristus dengan membaca Firman-Nya setiap hari.
  </div>

  <!-- NAVIGATION -->
  <nav class="main-nav">
    <button class="nav-tab is-active" data-tab="lesenplan">üìñ Bacaan</button>
    <button class="nav-tab" data-tab="about">üë§ Tentang Saya</button>
    <button class="nav-tab" data-tab="journal">üìù Jurnal</button>
  </nav>

  <!-- TAB: RENCANA BACAAN -->
  <div id="tab-lesenplan" class="tab-section active">
    <div class="layout">
      <!-- Left -->
      <section class="card">
        <h2>Pilih Hari</h2>
        <div class="day-list" id="dayList"></div>
      </section>

      <!-- Right -->
      <aside class="card">
        <h2>Kemajuanmu</h2>
        <p id="progressText">0 dari 31 hari selesai (0%).</p>
        <div class="progress-bar">
          <div id="progressFill" class="progress-fill"></div>
        </div>

        <p class="bible-note">
          Untuk teks Alkitab, kami menggunakan
          <a href="https://www.bible.com/app" target="_blank" rel="noopener noreferrer">
            YouVersion Bible App
          </a>
          (Terjemahan Baru ‚Äì TB).
        </p>
      </aside>
    </div>
  </div>
   
  <!-- TAB: ABOUT -->
  <div id="tab-about" class="tab-section">
    <div class="about-card">
      <h2 style="color:var(--gold)">Tentang Saya</h2>

      <p>
        Saya Gabriella dan tinggal di Austria. Saya berasal dari Papua Barat di Indonesia
        dan adalah pengikut Yesus Kristus.
      </p>

      <p>
        Saya berasal dari keluarga dengan iman yang kuat kepada Tuhan Yesus, dan iman itu
        membentuk hidup saya sejak masa kecil.
      </p>

      <p>
        Semua bacaan Alkitab dalam rencana ini mengikuti rencana bacaan satu tahun Gideons,
        yang juga saya pakai secara pribadi.
      </p>

      <p>
        Jika kamu punya pertanyaan atau ingin berbagi kesaksian, saya sangat senang
        menerima pesanmu via Instagram <strong>@gabriellasapari</strong> atau email di
        <a href="mailto:gabriellaasw94@gmail.com">gabriellaasw94@gmail.com</a>.
      </p>
    </div>
  </div>

  <!-- TAB: JURNAL -->
  <div id="tab-journal" class="tab-section">
    <div class="journal-card">
      <h2 style="color:var(--gold)">Jurnal &amp; Doa</h2>

      <div class="journal-controls">
        <label for="journal-day">Hari:</label>
        <select id="journal-day"></select>
      </div>

      <textarea
        id="journal-text"
        class="journal-textarea"
        placeholder="Apa yang Tuhan sampaikan kepadamu hari ini? Apa yang ingin kamu doakan atau serahkan kepada-Nya?"
      ></textarea>

      <button id="journal-save" class="journal-save-btn">Simpan</button>
      <p id="journal-status" style="font-size:12px;color:var(--muted);margin-top:6px;"></p>
    </div>
  </div>

  <!-- FOCUS OVERLAY -->
  <div id="focusOverlay" class="focus-overlay">
    <div class="focus-dialog">
      <button id="focusClose" class="focus-close">&times;</button>
      <p id="focusDate" style="font-size:12px;color:var(--muted);margin-bottom:4px;"></p>
      <h2 id="focusTitle" style="margin-top:0;color:var(--gold)"></h2>
      <p id="focusMorning"></p>
      <p id="focusEvening"></p>
    </div>
  </div>

  <!-- PRIVACY NOTE -->
  <section style="background:var(--card-bg);padding:15px 20px;border-radius:12px;
                margin-top:30px;font-size:13px;color:var(--muted);line-height:1.6;">
    <h3 style="margin-top:0;margin-bottom:8px;font-size:15px;color:var(--gold);">
        Privasi &amp; Keamanan
    </h3>
    <p>
        Kemajuan bacaan dan catatan jurnalmu hanya disimpan secara lokal di browser
        di perangkat ini. Data tersebut tidak dikirim ke server mana pun dan tidak
        dapat dilihat oleh orang lain ‚Äì bahkan tidak oleh saya sebagai pembuat halaman ini.
        Jika kamu menghapus riwayat browser atau data situs ini, semua kemajuan dan catatan
        yang tersimpan juga akan terhapus.
    </p>
  </section>
       
  <footer style="text-align:center;margin-top:30px;font-size:12px;color:var(--muted)">
    Dibuat dengan kasih oleh Gabriella
  </footer>

</div>

<!-- MUSIC SOURCE -->
<audio id="player" preload="auto"></audio>

<script>

/* ---------------------------------------------------
   31-DAY READING PLAN (JANUARI 2026)
--------------------------------------------------- */

const plan = [
  { day: 1,  morning: "Kej 1‚Äì2",   evening: "Mat 1" },
  { day: 2,  morning: "Kej 3‚Äì5",   evening: "Mat 2" },
  { day: 3,  morning: "Kej 6‚Äì8",   evening: "Mat 3" },
  { day: 4,  morning: "Kej 9‚Äì11",  evening: "Mat 4" },
  { day: 5,  morning: "Kej 12‚Äì14", evening: "Mat 5:1‚Äì26" },
  { day: 6,  morning: "Kej 15‚Äì17", evening: "Mat 5:27‚Äì48" },
  { day: 7,  morning: "Kej 18‚Äì19", evening: "Mat 6" },
  { day: 8,  morning: "Kej 20‚Äì22", evening: "Mat 7" },
  { day: 9,  morning: "Kej 23‚Äì24", evening: "Mat 8" },
  { day:10,  morning: "Kej 25‚Äì26", evening: "Mat 9:1‚Äì17" },
  { day:11,  morning: "Kej 27‚Äì28", evening: "Mat 9:18‚Äì38" },
  { day:12,  morning: "Kej 29‚Äì30", evening: "Mat 10:1‚Äì23" },
  { day:13,  morning: "Kej 31‚Äì32", evening: "Mat 10:24‚Äì42" },
  { day:14,  morning: "Kej 33‚Äì35", evening: "Mat 11" },
  { day:15,  morning: "Kej 36‚Äì37", evening: "Mat 12:1‚Äì21" },
  { day:16,  morning: "Kej 38‚Äì40", evening: "Mat 12:22‚Äì50" },
  { day:17,  morning: "Kej 41",    evening: "Mat 13:1‚Äì32" },
  { day:18,  morning: "Kej 42‚Äì43", evening: "Mat 13:33‚Äì58" },
  { day:19,  morning: "Kej 44‚Äì45", evening: "Mat 14:1‚Äì21" },
  { day:20,  morning: "Kej 46‚Äì48", evening: "Mat 14:22‚Äì36" },
  { day:21,  morning: "Kej 49‚Äì50", evening: "Mat 15:1‚Äì20" },
  { day:22,  morning: "Kel 1‚Äì3",   evening: "Mat 15:21‚Äì39" },
  { day:23,  morning: "Kel 4‚Äì6",   evening: "Mat 16" },
  { day:24,  morning: "Kel 7‚Äì8",   evening: "Mat 17" },
  { day:25,  morning: "Kel 9‚Äì10",  evening: "Mat 18:1‚Äì20" },
  { day:26,  morning: "Kel 11‚Äì12", evening: "Mat 18:21‚Äì35" },
  { day:27,  morning: "Kel 13‚Äì15", evening: "Mat 19:1‚Äì15" },
  { day:28,  morning: "Kel 16‚Äì18", evening: "Mat 19:16‚Äì30" },
  { day:29,  morning: "Kel 19‚Äì21", evening: "Mat 20:1‚Äì16" },
  { day:30,  morning: "Kel 22‚Äì24", evening: "Mat 20:17‚Äì34" },
  { day:31,  morning: "Kel 25‚Äì26", evening: "Mat 21:1‚Äì22" }
];

/* ---------------------------------------------------
   RENDER DAY LIST
--------------------------------------------------- */

const STORAGE_KEY = "lesenplan-darkluxe";
const dayListEl = document.getElementById("dayList");
const progressTextEl = document.getElementById("progressText");
const progressFillEl = document.getElementById("progressFill");

function getState() {
  const raw = localStorage.getItem(STORAGE_KEY);
  return raw ? JSON.parse(raw) : {};
}

function setState(s) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(s));
}

function render() {
  const state = getState();
  dayListEl.innerHTML = "";
  let doneCount = 0;

  const today = new Date();
  const isJan2026 =
  today.getFullYear() === 2026 && today.getMonth() === 0;
  const todayDay = isJan2026 ? today.getDate() : null;

  plan.forEach(({ day, morning, evening }) => {
    const done = state[day]?.done ?? false;
    if (done) doneCount++;

    const card = document.createElement("div");
    card.className = "day-card";

    if (todayDay && day === todayDay) {
      card.classList.add("today");
      const badge = document.createElement("div");
      badge.className = "today-badge";
      badge.textContent = "Hari ini";
      card.appendChild(badge);
    }

    const num = document.createElement("div");
    num.className = "day-num";
    num.textContent = day;

    const content = document.createElement("div");
    content.style.flex = "1";

    const title = document.createElement("div");
    title.className = "day-title";
    title.textContent = `Hari ${day}`;

    const rowM = document.createElement("div");
    rowM.className = "day-ref-row";

    const labelM = document.createElement("span");
    labelM.className = "day-ref-label";
    labelM.textContent = "Pagi";

    const textM = document.createElement("button");
    textM.className = "ref-link-text";
    textM.type = "button";
    textM.textContent = morning;
    textM.onclick = () => openBibleReference(morning);

    rowM.appendChild(labelM);
    rowM.appendChild(textM);

    const rowE = document.createElement("div");
    rowE.className = "day-ref-row";

    const labelE = document.createElement("span");
    labelE.className = "day-ref-label";
    labelE.textContent = "Malam";

    const textE = document.createElement("button");
    textE.className = "ref-link-text";
    textE.type = "button";
    textE.textContent = evening;
    textE.onclick = () => openBibleReference(evening);

    rowE.appendChild(labelE);
    rowE.appendChild(textE);

    content.appendChild(title);
    content.appendChild(rowM);
    content.appendChild(rowE);

    const actions = document.createElement("div");
    actions.style.display = "flex";
    actions.style.flexDirection = "column";
    actions.style.gap = "6px";

    const btn = document.createElement("button");
    btn.className = "btn-small";
    btn.textContent = done ? "Selesai" : "Belum";
    if (done) btn.classList.add("is-done");

    btn.onclick = () => {
      const s = getState();
      if (s[day]?.done) {
        delete s[day];
      } else {
        s[day] = { done: true, ts: Date.now() };
      }
      setState(s);
      render();
    };

    const focusBtn = document.createElement("button");
    focusBtn.className = "btn-small";
    focusBtn.textContent = "Baca dalam fokus";
    focusBtn.onclick = () => openFocus(day, morning, evening);

    const reset = document.createElement("span");
    reset.className = "reset-link";
    reset.textContent = "Reset";
    reset.onclick = () => {
      const s = getState();
      delete s[day];
      setState(s);
      render();
    };

    actions.appendChild(btn);
    actions.appendChild(focusBtn);
    actions.appendChild(reset);

    card.appendChild(num);
    card.appendChild(content);
    card.appendChild(actions);

    dayListEl.appendChild(card);
  });

  const percent = Math.round((doneCount / plan.length) * 100);
  progressTextEl.textContent =
    `${doneCount} dari ${plan.length} hari selesai (${percent}%).`;
  progressFillEl.style.width = percent + "%";
}

render();

/* ---------------------------------------------------
   YOUVERSION AUTO-ROUTING (MOBILE vs DESKTOP)
--------------------------------------------------- */

function isMobile() {
  return /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
}

const youvBookMap = {
  "Yeh":      "EZK",
  "Dan":      "DAN",
  "Hos":      "HOS",
  "Yoel":     "JOL",
  "Amos":     "AMO",
  "Obaja":    "OBA",
  "Yunus":    "JON",
  "Mikha":    "MIC",
  "Nahum":    "NAH",
  "Habakuk":  "HAB",
  "Zefanya":  "ZEP",
  "Hagai":    "HAG",
  "Zak":      "ZEC",
  "Maleakhi":"MAL",

  "Ibr":   "HEB",
  "Yak":   "JAS",
  "Yudas": "JUD",
  "Wahyu": "REV"
};

function parseReference(refText) {
  if (!refText) return null;
  const parts = refText.split(/\s+/, 2);
  if (parts.length < 2) return null;

  const bookToken = parts[0];
  const rest = parts[1];

  const bookCode = youvBookMap[bookToken];
  if (!bookCode) return null;

  const match = rest.match(/(\d+)/);
  if (!match) return null;

  const chapter = match[1];
  return { bookCode, chapter };
}

function openBibleReference(refText) {
  const parsed = parseReference(refText);
  if (!parsed) {
    alert("Ayat Alkitab ini belum dapat dikenali secara otomatis.");
    return;
  }

  const { bookCode, chapter } = parsed;

  // TB = 116, kode kitab: ENG bookCode (REV, HEB, dll.)
  const desktopUrl = `https://www.bible.com/bible/116/${bookCode}.${chapter}.TB`;
  const mobileUrl  = `youversion://bible?reference=${bookCode}.${chapter}`;

  const finalUrl = isMobile() ? mobileUrl : desktopUrl;
  window.open(finalUrl, "_blank", "noopener");
}

/* ---------------------------------------------------
   FOCUS MODE
--------------------------------------------------- */

const focusOverlay = document.getElementById("focusOverlay");
const focusClose = document.getElementById("focusClose");
const focusDateEl = document.getElementById("focusDate");
const focusTitleEl = document.getElementById("focusTitle");
const focusMorningEl = document.getElementById("focusMorning");
const focusEveningEl = document.getElementById("focusEvening");

function openFocus(day, morning, evening) {
  focusTitleEl.textContent = `Hari ${day}`;
  focusMorningEl.textContent = `Pagi: ${morning}`;
  focusEveningEl.textContent = `Malam: ${evening}`;
  focusDateEl.textContent = `Januari 2026 ‚Äì Hari ${day}`;

  focusOverlay.classList.add("is-open");
  document.body.style.overflow = "hidden";
}

function closeFocus() {
  focusOverlay.classList.remove("is-open");
  document.body.style.overflow = "";
}

focusClose.onclick = () => {
  closeFocus();
};

focusOverlay.addEventListener("click", (e) => {
  if (e.target === focusOverlay) {
    closeFocus();
  }
});

/* ---------------------------------------------------
   TAB SWITCHING
--------------------------------------------------- */

document.querySelectorAll(".nav-tab").forEach(btn => {
  btn.onclick = () => {
    document.querySelector(".nav-tab.is-active").classList.remove("is-active");
    btn.classList.add("is-active");

    document.querySelector(".tab-section.active").classList.remove("active");
    document.getElementById("tab-" + btn.dataset.tab).classList.add("active");
  };
});

/* ---------------------------------------------------
   THEME TOGGLE
--------------------------------------------------- */

const themeBtn = document.getElementById("theme-toggle");

if (localStorage.getItem("theme") === "light") {
  document.body.dataset.theme = "light";
  themeBtn.textContent = "üåô";
}

themeBtn.onclick = () => {
  if (document.body.dataset.theme === "light") {
    document.body.removeAttribute("data-theme");
    localStorage.setItem("theme", "dark");
    themeBtn.textContent = "‚òÄ";
  } else {
    document.body.dataset.theme = "light";
    localStorage.setItem("theme", "light");
    themeBtn.textContent = "üåô";
  }
};

/* ---------------------------------------------------
   JOURNAL PER HARI
--------------------------------------------------- */

const journalDaySelect = document.getElementById("journal-day");
const journalText = document.getElementById("journal-text");
const journalStatus = document.getElementById("journal-status");
const JOURNAL_KEY = "journal-darkluxe-v2";

let journalStore = {};
try {
  const saved = localStorage.getItem(JOURNAL_KEY);
  journalStore = saved ? JSON.parse(saved) : {};
} catch {
  journalStore = {};
}

if (journalDaySelect) {
  plan.forEach(({ day }) => {
    const opt = document.createElement("option");
    opt.value = String(day);
    opt.textContent = `Hari ${day}`;
    journalDaySelect.appendChild(opt);
  });

  const t = new Date();
  if (t.getFullYear() === 2026 && t.getMonth() === 0) {
    const dd = t.getDate();
    const opt = [...journalDaySelect.options].find(o => Number(o.value) === dd);
    if (opt) journalDaySelect.value = String(dd);
  }
}

function loadJournalForDay(day) {
  journalText.value = journalStore[day] || "";
}

if (journalDaySelect) {
  loadJournalForDay(journalDaySelect.value);

  journalDaySelect.addEventListener("change", () => {
    loadJournalForDay(journalDaySelect.value);
    journalStatus.textContent = "";
  });
}

document.getElementById("journal-save").onclick = () => {
  const day = journalDaySelect.value;
  journalStore[day] = journalText.value || "";
  localStorage.setItem(JOURNAL_KEY, JSON.stringify(journalStore));
  journalStatus.textContent = "Tersimpan ‚úì";
};

/* ---------------------------------------------------
   LANGUAGE SWITCHER (DE ‚áÑ ID)
--------------------------------------------------- */

const langBtn = document.getElementById("lang-toggle");
const isIndo = window.location.pathname.includes("index-id.html");

if (isIndo) {
  langBtn.textContent = "DE";
} else {
  langBtn.textContent = "ID";
}

langBtn.onclick = () => {
  const path = window.location.pathname;

  if (path.includes("index-id.html")) {
    window.location.href = "index.html";
  } else {
    window.location.href = "index-id.html";
  }
};

/* ---------------------------------------------------
   MUSIC PLAYER + PLAY BUTTON
--------------------------------------------------- */

const player = document.getElementById("player");
const musicSelect = document.getElementById("music-select");
const musicPlayBtn = document.getElementById("music-play");

const musicSources = {
  ambient: "https://raw.githubusercontent.com/gabriellasapari/bibel-leseplan/main/ambient-worship-music-112199.mp3"
};

let isPlaying = false;

function setMusicFromSelect(autoPlay = false) {
  const src = musicSources[musicSelect.value];
  if (!src) return;
  player.src = src;
  if (autoPlay) {
    player.play().then(() => {
      isPlaying = true;
      updatePlayButton();
    }).catch(() => {
      // Autoplay blockiert ‚Äì Nutzer kann manuell auf Play dr√ºcken
      isPlaying = false;
      updatePlayButton();
    });
  }
}

function updatePlayButton() {
  musicPlayBtn.textContent = isPlaying ? "‚è∏" : "‚ñ∂";
}

// Klick auf Play / Pause
musicPlayBtn.addEventListener("click", () => {
  // Falls noch keine Quelle gesetzt ist
  if (!player.src) {
    setMusicFromSelect(false);
  }

  if (isPlaying) {
    player.pause();
    isPlaying = false;
    updatePlayButton();
  } else {
    player.play().then(() => {
      isPlaying = true;
      updatePlayButton();
    }).catch(() => {
      // wenn Play fehlschl√§gt, nichts tun
    });
  }
});

// Wenn Track zu Ende ist -> Button zur√ºck auf ‚ñ∂
player.addEventListener("ended", () => {
  isPlaying = false;
  updatePlayButton();
});

// Falls du sp√§ter mehrere Musik-Optionen hast
musicSelect.addEventListener("change", () => {
  const shouldPlay = isPlaying;
  setMusicFromSelect(shouldPlay);
});

// Initial: Quelle setzen, aber noch nicht abspielen
setMusicFromSelect(false);
updatePlayButton();

</script>

<script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("sw.js");
  }
</script>

</body>
</html>
